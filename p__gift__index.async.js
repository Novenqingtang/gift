"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[679],{53050:function(e,n,r){r.r(n),r.d(n,{default:function(){return X}});var s=r(15009),t=r.n(s),a=r(99289),i=r.n(a),l=r(5574),c=r.n(l),d=r(67294),o=r(54647),u=r(77985),m=r(20661),x=r(13455),f=r(14652),h=r(12461),v=r(26303),p=r(53826),b=r(71577),j=r(90567),k=r(14538),N=r(66703),w=r(27484),g=r.n(w),y=r(68754),Z=r(85893);function I(e){var n=e.message;return(0,Z.jsx)(Z.Fragment,{children:null!=n?n:"404 not found"})}var C=r(9279),S=r(55375),P=r(23803),E=r(18133),F=r(11744),A=r(10126),O=r(86784),R=r(56446),T=r(49006),H=r(13290),L=r(51641),M=r(76909),U=r(56371),W=r(61702),D=r(24016),Y=r(26713),B=r(85593);function K(e){var n=e.tokenid,r=e.cancel,s=e.submit,a=(0,u.useWeb3React)(),l=a.chainId,o=a.account,m=a.provider,x=(0,d.useState)(!1),f=c()(x,2),v=f[0],p=f[1],j=(0,d.useRef)(null),k={address:[{required:!0,message:"Please input to address"},{validator:function(e,n){return n?(0,y.U)(n)?Promise.resolve():Promise.reject(new Error("Invalid address")):Promise.resolve()}}]},N=function(){var e=i()(t()().mark((function e(){var r,a,i,c;return t()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=2;break}return e.abrupt("return",h.ZP.warn("on transferring..."));case 2:return e.next=4,null===(r=j.current)||void 0===r?void 0:r.validateFields();case 4:if(a=e.sent,m&&o&&l){e.next=7;break}return e.abrupt("return",h.ZP.warn("Something warn in network, please check and try again."));case 7:return v||p(!0),i=(0,T.u)(S.x,P,m,o),e.prev=9,e.next=12,i.transferFrom(o,a.address,n);case 12:return c=e.sent,e.next=15,c.wait();case 15:h.ZP.success("Transfer successfully."),s(),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(9),console.error("[handleTransferAction] [transferFrom] [error]:",e.t0),h.ZP.error((0,B.k)(e.t0));case 23:return e.prev=23,p(!1),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[9,19,23,26]])})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsxs)("div",{children:[(0,Z.jsx)(W.Z,{ref:j,layout:"vertical",children:(0,Z.jsx)(W.Z.Item,{label:"Recipient Address",name:"address",rules:k.address,children:(0,Z.jsx)(D.Z,{placeholder:"Recipient address",disabled:v})})}),(0,Z.jsx)("div",{className:"flex justify-end",children:(0,Z.jsxs)(Y.Z,{children:[(0,Z.jsx)(b.Z,{onClick:function(){r()},disabled:v,children:"Cancel"},"back"),(0,Z.jsx)(b.Z,{onClick:function(){N()},loading:v,children:"Submit"},"submit")]})})]})}var _=r(81268),V=new R.ZP;function q(e){var n=e.onClick,r=e.chain;return(0,Z.jsx)("div",{className:"mt-8 flex items-center justify-center",children:(0,Z.jsxs)("div",{className:" px-1 py-1 cursor-pointer bg-[#ffadd2] text-[#fff] rounded-1 hover:bg-[#f759ab]",onClick:function(){n(r)},children:["Switch to ",x.Iy[r]]})})}function G(e){var n=e.onClick;return(0,Z.jsx)("div",{className:"mt-8 flex items-center justify-center",children:(0,Z.jsx)("div",{className:" px-1 py-1 cursor-pointer bg-[#ffadd2] text-[#fff] rounded-1 hover:bg-[#f759ab]",onClick:function(){n()},children:"Connect Wallet"})})}function X(){var e,n,r,s=(0,o.useParams)(),a=(0,u.useWeb3React)(),l=a.chainId,w=a.account,R=a.provider,W=(0,m.bt)(l),D=s.chain,Y=void 0===D?"":D,X=s.tokenid,z=void 0===X?"":X;if(!Y||!z)return null;var J=(0,x.np)(Y);if(!J||!(0,x.IM)(J))return null;if(!l)return null;var Q=(0,o.useModel)("accountDrawerModel").toggleAccountDrawer,$=(0,f.Z)(),ee=!!w,ne=!!W&&(0,x.IM)(l),re=J===l,se=(0,d.useState)(!1),te=c()(se,2),ae=te[0],ie=te[1],le=(0,d.useState)(!1),ce=c()(le,2),de=ce[0],oe=ce[1],ue=(0,d.useState)(!0),me=c()(ue,2),xe=me[0],fe=me[1],he=(0,d.useState)(!1),ve=c()(he,2),pe=ve[0],be=ve[1],je=(0,d.useState)(null),ke=c()(je,2),Ne=ke[0],we=ke[1],ge=(0,d.useState)([]),ye=c()(ge,2),Ze=ye[0],Ie=ye[1],Ce=(0,d.useState)(!1),Se=c()(Ce,2),Pe=Se[0],Ee=Se[1],Fe=(0,d.useState)(!1),Ae=c()(Fe,2),Oe=Ae[0],Re=Ae[1],Te=function(){var e=i()(t()().mark((function e(){var n,r,s,a,i,c,d,o,u,m,x,f,h;return t()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Re(!1),l&&w&&R){e.next=3;break}return e.abrupt("return",null);case 3:return r=[{address:S.IL,abi:E,method:"getBox",params:[z]},{address:S.x,abi:P,method:"ownerOf",params:[z]},{address:S.IL,abi:E,method:"getBoxAssets",params:[z]}],e.next=6,V.call({chainId:l,provider:R,calls:r,isStrict:!1});case 6:if("string"!=typeof(s=e.sent)[0]){e.next=9;break}return e.abrupt("return",null);case 9:if(null!==(n=s[0])&&void 0!==n&&n.name){e.next=11;break}return e.abrupt("return",null);case 11:if(a="string"!=typeof s[2]?s[2]:[],i=[],!a.length){e.next=52;break}c=0;case 15:if(!(c<a.length)){e.next=52;break}if(a[c].token!==C.d){e.next=19;break}return i[c]={address:a[c].token,amount:a[c].amount,type:H.h.NATIVE,decimals:18,name:"ETH",symbol:"ETH"},e.abrupt("continue",49);case 19:return e.next=21,(0,L.vE)(R,a[c].token);case 21:if(e.sent){e.next=25;break}return i[c]={address:a[c].token,amount:a[c].amount,type:H.h.UNKNOWN,decimals:18,name:M.HH,symbol:M.eu},e.abrupt("continue",49);case 25:return d=void 0,o=[{address:a[c].token,abi:F,method:"name",params:[]},{address:a[c].token,abi:F,method:"symbol",params:[]},{address:a[c].token,abi:F,method:"decimals",params:[]},{address:a[c].token,abi:A,method:"name",params:[]},{address:a[c].token,abi:A,method:"symbol",params:[]}],e.prev=27,e.next=30,V.call({chainId:l,provider:R,calls:o,isStrict:!1});case 30:if("0x"==(u=e.sent)[2]){e.next=35;break}d=H.h.ERC20,e.next=40;break;case 35:return m=(0,T.u)(a[c].token,O,R),e.next=38,m.uri(1).catch((function(e){return e.toString().includes("revert")?0:-1}));case 38:x=e.sent,d=x?H.h.ERC1155:0===x?H.h.ERC721:H.h.UNKNOWN;case 40:f=(0,M.ek)(u[0],u[3],M.HH),h=(0,M.ek)(u[1],u[4],M.eu),d===H.h.ERC20?i[c]={address:a[c].token,amount:a[c].amount,type:d,decimals:u[2],name:f,symbol:h}:d===H.h.ERC721&&(i[c]={address:a[c].token,tokenid:a[c].amount,type:d,decimals:-1,name:f,symbol:h}),e.next=49;break;case 45:e.prev=45,e.t0=e.catch(27),console.error("error",e.t0),i[c]={address:a[c].token,amount:a[c].amount,type:H.h.UNKNOWN,decimals:18,name:M.HH,symbol:M.eu};case 49:c++,e.next=15;break;case 52:return e.abrupt("return",{box:s[0],isOwner:"0x"!==s[1]&&s[1].toLocaleLowerCase()===w.toLocaleLowerCase(),assets:i});case 53:case"end":return e.stop()}}),e,null,[[27,45]])})));return function(){return e.apply(this,arguments)}}(),He=function(){var e=i()(t()().mark((function e(){var n,r;return t()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!pe){e.next=2;break}return e.abrupt("return",h.ZP.warn("on unpacking..."));case 2:if(de&&Ze.length){e.next=4;break}return e.abrupt("return");case 4:if(l&&w&&R){e.next=6;break}return e.abrupt("return",h.ZP.warn("Something warn in network, please check and try again."));case 6:return pe||be(!0),n=(0,T.u)(S.IL,E,R,w),e.prev=8,e.next=11,n.unpack(z);case 11:return r=e.sent,e.next=14,r.wait();case 14:h.ZP.success("Transfer successfully."),Ie([]),oe(!1),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(8),console.error("[handleUnpackAction] [unpack] [error]:",e.t0),h.ZP.error((0,B.k)(e.t0));case 23:return e.prev=23,be(!1),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[8,19,23,26]])})));return function(){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){var e=!0;return xe||fe(!0),i()(t()().mark((function n(){var r,s,a,i,l,c;return t()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(re&&ne){n.next=3;break}return fe(!1),n.abrupt("return");case 3:return n.prev=3,n.next=6,Te();case 6:if(r=n.sent,!e){n.next=18;break}if(r){n.next=10;break}throw new Error("Gift is not fount.");case 10:s=r.box,a=r.isOwner,i=r.assets,we(s),ie(a),Ie(i),l=s.canOpenAfter,c=g()().isAfter(g().unix(l.toNumber()).valueOf()),oe(c),fe(!1);case 18:n.next=24;break;case 20:n.prev=20,n.t0=n.catch(3),console.error("[getInfo] [error]:",n.t0),e&&Ee(!0);case 24:return n.prev=24,e&&fe(!1),n.finish(24);case 27:case"end":return n.stop()}}),n,null,[[3,20,24,27]])})))(),function(){e=!1}}),[J,l,w,re,ne]),(0,Z.jsx)("div",{className:"pt-2 px-0.5 sm:px-0 ",children:ee?ne&&re?Pe?xe?(0,Z.jsx)(Z.Fragment,{}):(0,Z.jsx)(I,{}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{className:"flex items-center mb-1",children:(0,Z.jsxs)("div",{className:"text-1.25 font-bold",children:["Box Detail #",z]})}),(0,Z.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,Z.jsx)("div",{className:"md:flex-3 md:max-w-[50%] md:min-w-[40%] md:w-0 ",children:(0,Z.jsx)("div",{className:"relative  md:mr-1.25 mb-1.25 border  border-solid border-slate-200 rounded-0.0625 overflow-hidden",children:(0,Z.jsx)("div",{className:"relative h-0 pb-[100%]",children:(0,Z.jsx)("div",{style:{inset:"0px"},className:"absolute",children:(0,Z.jsx)("div",{className:"w-full h-full",children:(0,Z.jsx)("div",{className:"relative w-full h-full my-0 mx-auto cursor-pointer  min-h-[inherit] rounded-[inherit]",children:xe?(0,Z.jsx)(v.Z.Image,{className:"!w-full !h-full max-h-full max-w-full",active:!0}):(0,Z.jsx)("div",{className:"flex items-center justify-center flex-row h-full w-full min-h-[inherit] rounded-[inherit] relative",children:(0,Z.jsx)("div",{className:"h-full w-[1000px] flex items-center justify-center max-h-full min-w-full overflow-hidden relative rounded-[inherit]",children:(0,Z.jsx)(p.Z,{className:"w-auto h-auto max-h-full max-w-full rounded-[inherit] object-cover",preview:!1,src:_.c[null==Ne||null===(e=Ne.imageId)||void 0===e?void 0:e.toNumber()]||"",fallback:N})})})})})})})})}),(0,Z.jsx)("div",{className:" md:flex-4 md:-ml-1.25  md:w-0  ",children:xe?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{className:"md:ml-1.25 mb-1",children:(0,Z.jsx)(v.Z.Input,{active:!0})}),(0,Z.jsx)("div",{className:"md:ml-1.25 mb-1",children:(0,Z.jsx)(v.Z.Input,{active:!0})}),(0,Z.jsx)("div",{className:"md:ml-1.25 mb-1",children:(0,Z.jsx)(v.Z.Input,{active:!0,block:!0})}),(0,Z.jsx)("div",{className:"md:ml-1.25 mb-1",children:(0,Z.jsx)(v.Z.Input,{active:!0})}),(0,Z.jsxs)("div",{className:"md:ml-1.25 mb-1",children:[(0,Z.jsx)(v.Z.Input,{active:!0}),(0,Z.jsx)(v.Z.Input,{className:"ml-1",active:!0})]}),(0,Z.jsxs)("div",{className:"md:ml-1.25 mb-1",children:[(0,Z.jsx)(v.Z.Input,{active:!0}),(0,Z.jsx)(v.Z.Input,{className:"ml-1",active:!0})]}),(0,Z.jsx)("div",{className:"md:ml-1.25 mb-1",children:(0,Z.jsx)(v.Z.Input,{active:!0})}),(0,Z.jsx)("div",{className:"md:ml-1.25 mb-1",children:(0,Z.jsx)(v.Z.Input,{active:!0,block:!0})}),(0,Z.jsxs)("div",{className:"md:ml-1.25 mb-1",children:[(0,Z.jsx)(v.Z.Input,{active:!0}),(0,Z.jsx)(v.Z.Input,{className:"ml-1",active:!0})]})]}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{className:"md:ml-1.25 mb-1",children:(0,Z.jsxs)("div",{className:"text-1.125 underline",children:["#",z]})}),(0,Z.jsxs)("div",{className:"md:ml-1.25 mb-1 flex items-center",children:[(0,Z.jsx)("div",{children:"To"}),(0,Z.jsx)("div",{className:"ml-1 font-semibold",children:(null==Ne?void 0:Ne.name)||"unknown"})]}),(0,Z.jsx)("div",{className:"md:ml-1.25 mb-1",children:(0,Z.jsx)("div",{dangerouslySetInnerHTML:{__html:null!==(n=null==Ne?void 0:Ne.message)&&void 0!==n?n:"no message"}})}),(0,Z.jsxs)("div",{className:"md:ml-1.25 mb-1",children:[(0,Z.jsx)("div",{className:"text-1.125 font-bold mb-0.75",children:"Assets"}),(0,Z.jsx)("div",{children:Ze.length?Ze.map((function(e,n){return(0,Z.jsxs)("div",{className:"flex items-baseline mb-0.5",children:[(0,Z.jsx)("div",{className:"flex-3 max-w-[40%] md:max-w-[30%]",children:(0,Z.jsx)("div",{className:"mr-1.25 line-clamp-1",children:e.type!==H.h.NATIVE?(0,Z.jsx)("a",{href:"https://etherscan.io/address/".concat(e.address),target:"_blank",children:e.symbol||e.name||(0,y.X)(e.address)}):(0,Z.jsxs)(Z.Fragment,{children:[" ",e.symbol]})})}),(0,Z.jsxs)("div",{className:"flex-4 break-all",children:[e.amount&&!e.tokenid&&(0,Z.jsx)(Z.Fragment,{children:(0,U.formatUnits)(e.amount,e.decimals)}),!e.amount&&e.tokenid&&(0,Z.jsxs)(Z.Fragment,{children:["#",e.tokenid.toString()]})]})]},n)})):(0,Z.jsx)("div",{className:"text-[#ffd591]",children:"empty"})})]}),(0,Z.jsxs)("div",{className:"md:ml-1.25 mb-1",children:[(0,Z.jsx)("div",{className:"text-1.125 font-bold mb-0.75",children:"Can Open"}),Ze.length?de?(0,Z.jsx)(Z.Fragment,{children:"Right now"}):(0,Z.jsx)("div",{children:g()(1e3*((null==Ne||null===(r=Ne.canOpenAfter)||void 0===r?void 0:r.toNumber())||0)).format("YYYY-MM-DD")}):(0,Z.jsx)("div",{className:"text-[#ffd591]",children:"empty and already unpacked"})]}),(0,Z.jsx)("div",{className:"md:ml-1.25 mb-1 mt-2 md:mt-2.25 xl:mt-3",children:(0,Z.jsx)("div",{className:"flex items-center justify-center md:justify-start",children:ae?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(b.Z,{onClick:function(){He()},className:"mr-1",disabled:!de||!Ze.length,loading:pe,children:"Unpack"}),(0,Z.jsx)(b.Z,{type:"primary",onClick:function(){Re(!0)},children:"Send"})]}):(0,Z.jsx)(j.Z,{message:"Not your gift",type:"warning",showIcon:!0,banner:!0})})})]})})]}),(0,Z.jsx)(k.Z,{title:"Transfer Nft",open:Oe,onCancel:function(){Re(!1)},footer:null,destroyOnClose:!0,children:(0,Z.jsx)(K,{tokenid:z,submit:function(){Re(!1),o.history.push("/home")},cancel:function(){Re(!1)}})})]}):(0,Z.jsx)(q,{onClick:function(e){$(e)},chain:J}):(0,Z.jsx)(G,{onClick:Q})})}}}]);